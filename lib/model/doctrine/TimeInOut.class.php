<?php

/**
 * TimeInOut
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    cemetery
 * @subpackage model
 * @author     Your name here
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class TimeInOut extends BaseTimeInOut
{
    /**
	 * Function updatePageSize
	 * @todo Function For Change TimeInOut detail Of User
	 * @param time $snCurrentTime current time
	 * @param int  $snTotalHrs    Total hrs.
     * @param int  $ssStatus      Status.
	 * @return querystring
	 */
	public static function updateTimeInOutDetail($snCurrentTime,$snTotalHrs = '',$ssStatus,$snIdUser)
	{   
		if($snCurrentTime != '' && $ssStatus != '' && $snIdUser != '' && is_numeric($snIdUser))
		{						
			$oResult = Doctrine_Query::create()
			->update('TimeInOut')
            ->set('status','?',$ssStatus);
            
            if($ssStatus == 'OUT')
            {
                $oResult->set('total_hrs','?',$snTotalHrs)
                        ->set('time_out','?',$snCurrentTime);
            }
            else
            {
                $oResult->set('time_in','?',$snCurrentTime)
                        ->set('day_type_id','?',1);
            }
			$oResult->where('user_id =?',$snIdUser)   
                    ->AndWhere('task_date =?',date('Y-m-d'))
                    ->execute();
            return true;
		}
		return false;
	}
    
    /**
	 * Function updatePageSize
	 * @todo Function For Change TimeInOut detail Of User
	 * @param time $snCurrentTime current time
	 * @param int  $snTotalHrs    Total hrs.
     * @param int  $ssStatus      Status.
	 * @return querystring
	 */
    public function saveTimeInOutDetail($snIdUser,$snCurrentDate,$snCurrentTime,$ssStatus)
    {
        if($snCurrentDate != '' && $snCurrentTime != '' && $ssStatus != '' && $snIdUser != '' && is_numeric($snIdUser))
		{
            $this->setUserId($snIdUser);
            $this->setCreatedAt(date('Y-m-d H:i:s'));
            $this->setUpdatedAt(date('Y-m-d H:i:s'));
            $this->setTaskDate($snCurrentDate);
            $this->setTimeIn($snCurrentTime);            
            $this->setTotalHrs('');
            $this->setDayTypeId(1);
            $this->setStatus($ssStatus);
            $this->save();
            return true;
        }
        else
            return false;
    }
}
